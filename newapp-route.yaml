# my-new-app-route.yaml
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: my-new-app-route # Unique name for this Route
  namespace: <your-app-namespace>
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod # Optional: To link cert-manager to the Route for visibility/auto-creation in some tools
spec:
  host: my-new-app.apps.shift.example.com # The domain for this app
  to:
    kind: Service
    name: my-new-app-service # The Service your app exposes
    weight: 100
  port:
    targetPort: 8080-tcp # Or whatever port your app listens on (e.g., 8443-tcp)
  tls:
    # Choose ONE of these termination types:
    termination: edge # Router terminates TLS, sends PLAIN HTTP to targetPort
    # termination: reencrypt # Router terminates TLS, then re-encrypts to targetPort (if app expects HTTPS)
    # termination: passthrough # Router sends raw TLS through to targetPort (if app handles all TLS)

    insecureEdgeTerminationPolicy: Redirect # Common: Redirect HTTP to HTTPS

    # This links to the Secret generated by your Certificate resource:
    externalCertificate:
      name: my-new-app-secret # MUST match the 'secretName' from your Certificate

    # IMPORTANT: Only for 'reencrypt' termination (if app expects HTTPS)
    # destinationCACertificate: |
    #   # PASTE THE SERVICE-CA.CRT CONTENT HERE IF YOUR APP USES OPENSHIFT'S INTERNAL TLS
    #   # oc get cm openshift-service-ca.crt -n openshift-config-managed -o jsonpath='{.data.service-ca\.crt}'
